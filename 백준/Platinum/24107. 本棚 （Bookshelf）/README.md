# [Platinum IV] 本棚 (Bookshelf) - 24107 

[문제 링크](https://www.acmicpc.net/problem/24107) 

### 성능 요약

메모리: 6504 KB, 시간: 32 ms

### 분류

다이나믹 프로그래밍, 자료 구조, 세그먼트 트리, 가장 긴 증가하는 부분 수열 문제

### 제출 일자

2025년 12월 2일 15:31:35

### 문제 설명

<p>20XX 年，IOI が JOI 君の住む国で開催されることになった．このニュースを聞いた JOI 君は友人に知ら せるために部屋を飛び出そうとした．しかし，あまりにも急いでいたため部屋の本棚にぶつかってしまい， 本は本棚から全て落ちてしまった．とにかく急いでいた JOI 君は，落ちた本を順番を全く考慮せず全て本棚 に入れて家を出た．帰宅後，JOI 君は滅茶苦茶な順番に並んだ本を本来の順番に戻す作業が必要になった．</p>

<p>JOI 君の部屋の本棚は幅 N センチメートルであり，本棚には幅 1 センチメートルの本が N 冊入っている． 本には 1 から N までの番号がふられており，本来は本棚には左から 1, . . . , N の順番で本が並べられていた． また，本 i の重さは A<sub>i</sub> グラムである．</p>

<p>JOI 君は疲れていて本を同時にたくさん持ちたくなかったので，次のような操作を行うことで本棚を整 理することにした:</p>

<ul>
	<li>本棚に入っている本を 1 つ選び，取り出す．</li>
	<li>次に，本を取り出してできた隙間に隣接している本を動かすことを何度か行う．</li>
	<li>次に，取り出した本を本棚の隙間に戻す．</li>
</ul>

<p>本を本棚から同時に 2 冊以上取り出すことはできない．</p>

<p>例えば，本が左から 5, 3, 4, 1, 2 の順で並んでいるとき，本 1 を取り出し，本 4 と本 3 を順に右に動かし， 本 1 を本棚に戻すことで，本棚の本を左から 5, 1, 3, 4, 2 の順にすることができる．（下図）</p>

<p style="text-align: center;"><img alt="" src="https://upload.acmicpc.net/b677bbc0-a9f5-4278-9513-deeaa6ed1383/-/preview/" style="width: 160px; height: 197px;"></p>

<p>この操作で，JOI 君が重さ w グラムの本を本棚から取り出すとき，JOI 君はちょうど w カロリーを消費 する．また，JOI 君が重さ w グラムの本を本棚に戻すときも，JOI 君はちょうど w カロリーを消費する．ま た，本棚はなめらかな素材でできているので，JOI 君が本棚の中で本を動かすときには JOI 君はカロリー を消費しないとしてよい．</p>

<p>JOI 君は疲れていたので，なるべくカロリーを消費しないようにして本棚の本を本来の順番に戻すこと にした．</p>

<p>本の数と，それぞれの本の重さ，現在の本棚の本の並び順が与えられたとき，JOI 君が本棚の本を本来 の順番に並び替えるために消費するカロリーの合計の最小値を求めるプログラムを作成せよ．</p>

### 입력 

 <p>標準入力から以下の入力を読み込め．</p>

<ul>
	<li>1 行目には整数 N が書かれている．</li>
	<li>続く N 行には本の重さの情報が書かれている．i + 1 行目 (1 ≤ i ≤ N) には，本 i の重さを表す整数 A<sub>i</sub> が書かれている．</li>
	<li>続く N 行には現在の本棚の本の並び順の情報が書かれている．j + N + 1 行目 (1 ≤ j ≤ N) には，現 在左から j 番目にある本の番号を表す整数が書かれている．</li>
</ul>

### 출력 

 <p>標準出力に，JOI 君が消費するカロリーの合計の最小値を表す整数を 1 行で出力せよ．</p>

