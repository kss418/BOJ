# [Platinum III] 夜警 (Nightman) - 24147 

[문제 링크](https://www.acmicpc.net/problem/24147) 

### 성능 요약

메모리: 49352 KB, 시간: 44 ms

### 분류

플로이드–워셜, 기하학, 그래프 이론, 구현, 선분 교차 판정, 최단 경로

### 제출 일자

2025년 11월 25일 16:19:05

### 문제 설명

<p>広大な敷地の Y センターは，国営の複合研修施設であり，クラブの会合・合宿，市民楽団に よる定期演奏会，企業の新人研修など，多くの人々にさまざまな目的で利用されている．</p>

<p>以下の図にように，Y センターの敷地は横 w ×縦 h の長方形である．左下の座標が (0, 0)，右 上の座標が (w, h) である．</p>

<p style="text-align: center;"><img alt="" src="https://upload.acmicpc.net/a1abc205-0213-40bb-9baf-9783dbe3652d/-/preview/" style="width: 207px; height: 156px;"></p>

<p style="text-align: center;">図 1: 横 8，縦 6 の Y センター (w = 8, h = 6 の場合)</p>

<p>Y センターには b 個の建物がある．建物は全て長方形でその辺は座標軸のいずれかと平行で ある．建物の位置は 4 個の整数 (s<sub>i</sub>, t<sub>i</sub>, u<sub>i</sub>, v<sub>i</sub>) (i = 1, ..., b) で表される．i 番目の建物の左下の座 標が (s<sub>i</sub>, t<sub>i</sub>) であり，右上の座標が (u<sub>i</sub>, v<sub>i</sub>) であり，辺上は建物の領域として含まれず，建物と建 物が接していても間にはすきまがあり通ることができる．また建物の敷地は重複していない．</p>

<p>夜間の利用者の安全を守るため，a 人の警備員が座標 (x<sub>1</sub>, y<sub>1</sub>), ... ,(x<sub>a</sub>, y<sub>a</sub>) に配置されている． 警備員の配置位置は建物の外である．</p>

<p>深夜，Y センター内の警備は以下のように行われる．敷地内のある点で不審物が発見される と，そのたびに全ての警備員に連絡が入る．そして，その点までの移動距離が最も短い警備員 が現場に急行し，不審物の確認を行う．警備員は Y センター内を最短距離で移動するが，建物 内は深夜はロックされているため，建物の内部を通ることはできない．（建物の辺は建物に含ま れないので，建物の辺に沿って移動することはできる）不審物の確認が済むと，警備員は同じ 経路で自分の位置に戻る．次に不審物が発見されたときも同様に警備される．</p>

<p style="text-align: center;"><img alt="" src="https://upload.acmicpc.net/8118a01b-7c8a-4844-b963-576da21c46b3/-/preview/" style="width: 213px; height: 163px;"></p>

<p style="text-align: center;">図 2: 警備員が現場に急行する図 (○が警備員，×が不審物)</p>

<p>ある日の深夜，Yセンター内の建物の外で c 個の不審物が発見された．Yセンターの大きさと， 警備員の位置，建物の位置，そしてある日の深夜に発見された不審物の位置 (p<sub>1</sub>, q<sub>1</sub>), ... ,(p<sub>c</sub>, q<sub>c</sub>) が発見時刻の順に与えられたとき，警備員の移動距離の総和を求めるプログラムを作成せよ．</p>

### 입력 

 <p>入力の 1 行目には警備員の数を表す整数 a (1 ≤ a ≤ 10) と建 物の数を表す整数 b (1 ≤ b ≤ 50) と不審物の数を表す整数 c (1 ≤ c ≤ 10) が書かれている．</p>

<p>2 行目には Y センターの敷地の大きさを表す 2 つの整数 w, h (1 ≤ w, h ≤ 1000) が横，縦の 順に書かれている．</p>

<p>i + 2 行目 (1 ≤ i ≤ a) には，i 人目の警備員の場所を表す 2 つの整数 x<sub>i</sub>, y<sub>i</sub> (0 ≤ x<sub>i</sub> ≤ w, 0 ≤ y<sub>i</sub> ≤ h) が書かれている．j + a + 2 行目 (1 ≤ j ≤ b) には，j 人目の建物の場所を表す 4 つの整数 s<sub>j</sub>, t<sub>j</sub>, u<sub>j</sub>, v<sub>j</sub> (0 ≤ s<sub>j</sub> < u<sub>j</sub> ≤ w, 0 ≤ t<sub>j</sub> < v<sub>j</sub> ≤ h) が書かれている．k + a + b + 2 行目 (1 ≤ k ≤ c) には，k 人目の不審物の数を表す 2 つの整数 p<sub>k</sub>, q<sub>k</sub> (0 ≤ p<sub>a</sub> ≤ w, 0 ≤ q<sub>a</sub> ≤ h) が書かれている．</p>

### 출력 

 <p>出力は標準出力に行う．</p>

<p>警備員の移動距離の総和の小数点以下3桁で出力せよ．誤差は 0.001 以下でなければならない．</p>

