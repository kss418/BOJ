# [Platinum III] オリエンテーリング (Orienteering) - 24109 

[문제 링크](https://www.acmicpc.net/problem/24109) 

### 성능 요약

메모리: 18336 KB, 시간: 76 ms

### 분류

방향 비순환 그래프, 다이나믹 프로그래밍, 그래프 이론, 최단 경로, 위상 정렬

### 제출 일자

2025년 12월 2일 16:15:53

### 문제 설명

<p>あなたの通う JOI 高校では，年に一度，オリエンテーリングが行われ，全校生徒が参加する．オリエン テーリングとは，地図と方位磁針を用い，山野に設置されたチェックポイントを巡る競技である．</p>

<p>JOI 高校のオリエンテーリングは，2 人一組のチームで参加するという特徴がある．各チームの 2 人は， 指定されたスタート地点から一緒にスタートするが，その後は別々に行動をし，指定されたゴール地点を 目指す．2 人がゴール地点に到達した際，それぞれのチェックポイントをチームのうちの少なくとも 1 人 が訪れていないとならない．2 人は途中で同じ地点を訪れても構わない．また，2 人が途中で同じ道を通っ ても構わない．</p>

<p>JOI 高校のオリエンテーリングが行われる JOI 山には，N 個の地点があり，それらの間を M 本の道が 繋いでいる．N 個の地点には 1 から N までの番号が付いている．スタートはふもとにある地点 1 であり， ゴールは頂上の地点 N である．スタートとゴール以外の地点のうち一部または全部がチェックポイントと して指定される．</p>

<p>JOI 高校は，混乱を避けるため，オリエンテーリングの間，それぞれの道を，高度が低い方の地点から 高度が高い方の地点への一方通行とする．高度が等しい 2 つの地点は存在しない．スタートである地点 1 は最も高度の低い地点であり，ゴールである地点 N は最も高度の高い地点であるが，地点の番号は必ずし も高度の低い地点から順につけられているわけではないことに注意せよ．JOI 山では，このように道を一 方通行にしても，地点 1 から全ての地点に行くことができ，また，全ての地点から地点 N に行くことがで きる．</p>

<p>条件を満たすような一組のチームの 2 人の移動方法に関して，移動距離の合計の最小値を求めるプログ ラムを作成せよ．そのような 2 人の移動方法が存在することは保証されている．</p>

### 입력 

 <p>標準入力から以下の入力を読み込め．</p>

<ul>
	<li>1 行目には整数 N, M が空白を区切りとして書かれており，地点の数が N 個，道の数が M 本である ことを表す．</li>
	<li>続く N 行には各地点がチェックポイントであるかどうかの情報が書かれている．1+i 行目 (1 ≤ i ≤ N) には，0 か 1 の整数 S<sub>i</sub> が書かれており，S<sub>i</sub> が 0 の場合，地点 i はチェックポイントではなく，S<sub>i</sub> が 1 の場合，地点 i はチェックポイントであることを表す．常に S<sub>1</sub> = S<sub>N</sub> = 0 である．</li>
	<li>続く M 行には道の情報が書かれている．1 + N + j 行目 (1 ≤ j ≤ M) には，整数 A<sub>j</sub>, B<sub>j</sub>, C<sub>j</sub> が空白を区 切りとして書かれており，道 j は地点 A<sub>j</sub> から地点 B<sub>j</sub> を結び，道 j の長さが C<sub>j</sub> であることを表す． 地点 A<sub>j</sub> は地点 B<sub>j</sub> より高度が低い地点であり，道 j は地点 A<sub>j</sub> から地点 B<sub>j</sub> への一方通行となるもの とする．必ず A<sub>j</sub> ≠ B<sub>j</sub> であり，また，A<sub>j</sub> = A<sub>k</sub> かつ B<sub>j</sub> = B<sub>k</sub> なる道 k (k ≠ j) は存在しない．</li>
</ul>

### 출력 

 <p>条件を満たすような一組のチームの 2 人の移動方法に関する，移動距離の合計の最小値を出力せよ．</p>

