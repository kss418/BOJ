# [Platinum II] かくれんぼ (Hide-and-seek) - 24117 

[문제 링크](https://www.acmicpc.net/problem/24117) 

### 성능 요약

메모리: 10684 KB, 시간: 64 ms

### 분류

자료 구조, 세그먼트 트리, 스위핑, 느리게 갱신되는 세그먼트 트리, 오프라인 쿼리

### 제출 일자

2025년 11월 30일 22:21:49

### 문제 설명

<p>あなたは，JOI 社が発売したテレビゲームソフトを手に入れた．なかなか良くできたゲームであり，そ れなりに楽しみながら毎日プレイしていた．</p>

<p>ある日，ゲーマーの中で「かくれんぼ」と呼称されるステージが出現した．どうやらそのステージには バグがあり，優れたゲーマーでさえもほんのわずかな確率でしかクリアできない物であるらしい．</p>

<p>何度もそのステージに挑戦する中であなたは，とても高速な判断を行うことでクリアできる可能性が有 ることに気づき，プログラムを作成して対処出来るのではないかと考えた．</p>

<p>かくれんぼステージは，多数の障害物が配置された場所が舞台となっている．舞台は長方形で 1 × 1 の正 方形のマスに分かれており，各マスは 1 ≤ x ≤ 100, 000 ，1 ≤ y ≤ 1, 000, 000, 000 を満たす整数 x, y によっ て (x, y) と表現される．(1, 1) は左上隅のマスであり，(x + 1, y + 1) は (1, 1) から右に x，下に y 進んだマス を表現する．</p>

<p>各障害物は y 座標が同じ連続した w 個のマスに置かれる．つまり，障害物は w × 1 個のマスを占める長 方形の形に見える．その中の x 座標が一番小さいマスの座標 (x, y) と，長さ w の組で 1 つの障害物が表現 されている．障害物は 2 ≤ y のマスに配置される．障害物同士が重なることはない．</p>

<p>ステージが始まるとプレーヤーは舞台を動き回る．プレーヤーは障害物のあるマスを含めた任意のマス に移動できる．</p>

<p>一定の時間が経過すると敵が出現し攻撃を行う．プレーヤーはこの時必ず障害物の中に隠れる必要があ る．障害物の中に隠れるには，障害物のあるマスに居ればよい．適切な障害物の中に隠れることでプレー ヤーは攻撃を受けずに済み，敵に反撃するチャンスを得ることが出来る．チャンスを利用することでステー ジがクリアできる．</p>

<p>敵は M 種類の武器（例えば，拳銃，ライフル，無反動砲，電磁投射砲などなど）を所持している．武器 には 1 から M の固有の番号がつけられており，i 番の武器には攻撃力 a<sub>i</sub> が設定されている．攻撃力は，そ の数値の分だけ障害物を破壊出来ることを表している．</p>

<p>破壊された障害物の中にプレーヤーが隠れている場合，プレーヤーはダメージを受けることになる．</p>

<p>敵はランダムに選ばれた x を使い，(x, 1) に出現し，下方向に向かってランダムに選択した武器を使い攻 撃する予定だった．ところが，ゲームのバグによって，敵は必ずプレーヤーのいる x 座標を選択し，プレー ヤーに向けて攻撃してしまう事となった．</p>

<p>あなたは自作のプログラムを使い，敵からどの武器を使って攻撃されても良いように，武器毎に攻撃を 受けずに済む最適な隠れ場所を探すことにした．攻撃を受けずに済む最適な隠れ場所は，プレーヤーが反 撃を行いやすいように，もっとも y 座標が小さい所である．また，そのような場所が複数存在する場合に は，その中でもっとも x 座標が小さい所が最適である．</p>

<p>障害物の情報と各武器の攻撃力が与えられたとき，敵が所持する武器毎に最適な隠れ場所を求めるプロ グラムを作成せよ．ただし，どのように隠れても攻撃を受けてしまう場合には，隠れる場所がないという 意味で (-1,-1) を出力せよ．</p>

<p style="text-align: center;"><img alt="" src="https://upload.acmicpc.net/b1c8ddc8-707b-40a3-8e3d-306edf6db7f5/-/preview/" style="width: 427px; height: 236px;"></p>

<p style="text-align: center;">図 1: 攻撃力が 4 である武器に対応する隠れ方</p>

### 입력 

 <p>標準入力から以下の入力を読み込め．</p>

<ul>
	<li>1 行目には整数 N と M が空白を区切りとして書かれている．</li>
	<li>続く N 行のうち i 行目には整数 x<sub>i</sub>，y<sub>i</sub>，w<sub>i</sub> が空白を区切りとして書かれている．</li>
	<li>続く M 行のうち j 行目には整数 a<sub>j</sub> が書かれている．</li>
</ul>

### 출력 

 <p>標準出力に以下のデータを出力せよ．</p>

<ul>
	<li>データは M 行からなる．j 行目は 2 つの整数 xj と yj が空白区切りで書かれており，j 番目の武器に 対応する最適な隠れ場所の座標が (x<sub>j</sub>, y<sub>j</sub>) である事を表す．どのように隠れても j 番目の武器の攻撃 を受けてしまう場合は x<sub>j</sub> = y<sub>j</sub> = −1 とせよ．</li>
</ul>

