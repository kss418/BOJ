# [Gold IV] インフルエンザ (Flu) - 24141 

[문제 링크](https://www.acmicpc.net/problem/24141) 

### 성능 요약

메모리: 17248 KB, 시간: 152 ms

### 분류

구현, 그래프 이론, 그래프 탐색, 너비 우선 탐색

### 제출 일자

2025년 11월 23일 18:23:03

### 문제 설명

<p>今年は JOI 国でインフルエンザの大流行の兆しがある．JOI 国には n 個の都市 P<sub>1</sub>, . . . , P<sub>n</sub> が あり，都市 P<sub>i</sub> の場所は座標を用いて P<sub>i</sub>(x<sub>i</sub>, y<sub>i</sub>) と表される．異なる都市が同じ座標を持つことは ない．すなわち，i ̸= j であれば，(x<sub>i</sub> , y<sub>i</sub>) ≠ (x<sub>j</sub>, y<sub>j</sub>) である．また，都市 P<sub>1</sub> は首都の JOI 市で ある．</p>

<p>今年のインフルエンザは特別な型であり，次のような特徴がある．</p>

<ol>
	<li>各都市において，インフルエンザの流行はちょうど m 日間続く．すなわち，もし都市 P<sub>i</sub> でインフルエンザの流行が始まったとすると，P<sub>i</sub> におけるインフルエンザの流行はちょう ど m 日間続き，m 日後にはインフルエンザの流行は収まる．</li>
	<li>ある都市で一度インフルエンザが流行すると，その都市の市民の体内に抗体ができる．そ のため，インフルエンザが 1 つの都市で 2 回以上流行することはない．</li>
	<li>インフルエンザは日を追うごとに都市から都市へと流行を拡大する．その感染可能距離 は d である．もし，都市 Pi でインフルエンザの流行が始まったとする．都市 Pj と Pi の 距離が d 以下であり，まだ Pj ではインフルエンザは流行していない場合，その翌日に は，都市 Pj でインフルエンザの流行が始まる．（都市 P<sub>i</sub>(x<sub>i</sub>, y<sub>i</sub>) と P<sub>j</sub>(x<sub>j</sub>, y<sub>j</sub>) の間の距離は √((x<sub>i</sub> - x<sub>j</sub>)<sup>2</sup> + (y<sub>i</sub> - y<sub>j</sub>)<sup>2</sup>) である．）</li>
	<li>上に述べた以外の経路でインフルエンザの流行が拡大することはない．</li>
</ol>

<p>また，各 i = 1, . . . , n に対し，都市 Pi からの距離が d 以下であるような P<sub>i</sub> 以外の都市の数は 10 個以下である．</p>

<p>ある日，インフルエンザの流行が，JOI 市 P1 で始まった．JOI 市以外の都市では，今年は， まだインフルエンザは流行していない．JOI 国では，治療に必要なワクチンを効率よく手配す るため，インフルエンザの流行状況を予測することにした．</p>

<p>入力として，都市の数 n，1 つの都市でインフルエンザの流行が続く日数 m，インフルエンザ の感染可能距離 d，整数 k ≥ 1，各都市の座標が与えられたとき，JOI 市で流行が始まってから k 日後において，JOI 国内でインフルエンザが流行している都市の数を求めるプログラムを作成 せよ．</p>

### 입력 

 <p>入力の 1 行目には，JOI 国の都市の数 n (1 ≤ n ≤ 100, 000) が書か れている．2 行目には，各都市で流行が続く日数 m (1 ≤ m ≤ 100) が書かれている．3 行目に は感染可能距離 d (1 ≤ d ≤ 25) が書かれている．4 行目には整数 k (1 ≤ k ≤ 100) が書かれて いる．続く n 行 (5 行目～n + 4 行目) は都市 P<sub>1</sub>, . . . , P<sub>n</sub> の位置を表す．i + 4 行目 (1 ≤ i ≤ n) に は，2 つの整数 x<sub>i</sub>, y<sub>i</sub> (0 ≤ x<sub>i</sub>, y<sub>i</sub> < 1, 000) が空白を区切りとして書かれており，都市 P<sub>i</sub> の座標 が P<sub>i</sub>(x<sub>i</sub>, y<sub>i</sub>) であることを意味する．</p>

### 출력 

 <p>出力は，標準出力に行うこと．JOI 市で流行が始まってから k 日後において，JOI 国 内でインフルエンザが流行している都市の数を表す整数を 1 行で出力せよ．</p>

